---
title: "ch8"
output: html_document
---

# 제 8장 회귀분석을 위한 기본가정의 위배  
=========================================
## 제 1절 오차항의 비정규분포  
  
최소제곱 추정량은오차항이 비정규분포를 갖는 경우에도 BLUE가 된다. **(Best Linear Unbiased Estimator)**
그러나 오차항이 비정규분포인 경우 회귀모수에 대한 유의성 검정이나 신뢰구간 추정이 유효하지 못하다.


### 1. 잔차의 정규성 탐지  
  
  
#### 1) 잔차의 히스토그램에 의한 탐지  


오차항이 정규분포한다면 잔차항의 히스토그램은 1.좌우대칭 2.종모양 3.봉우리는 하나 의 특징을 가진다.
**(오차항 : 모집단, 잔차항 : 표본)**  

*예제8-1*
*Question. 제7장의 예제 7-20에서는 최근 42년간(1971~2005)의 민간최종소비지출, 가처분소득, 소비자물가지수를 이용하여 추세변수가 포함된 케인즈의 소비함수를 추정하였다. 이 결과를 바탕으로 오차항이 정규분포하는지 여부를 잔차의 히스토그램을 통해 살펴보라.*
```{r}
key<-read.table("C:/psy/Rdata/Keynes.txt",header=T)
real.C<-(key$C/key$CPI*100)
real.Y<-(key$Y/key$CPI*100)
t.sq<-(1:42)^2
key.res<-lm(real.C ~ real.Y + t.sq)
hist(resid(key.res))
#다른 밖의 방법 , Q-Q plot (정규성 확인, 점들이 직선에 모여있을수록 대상이 정규분포를 따른다.)  
qqnorm(resid(key.res))
qqline(resid(key.res))
```

#### 2) 자크-베라(Jarque-Bera)의 검정통계량  

히스토그램은 시각적으로 오차항의 분포형태를 쉽게 알 수 있으나 정확하게 판단할 수 없으므로 오차항의 정규분포 검정이 필요하다.  



왜도와 초과첨도의 추정량.  
$${sk}=\frac{\mu_3}{\sigma^3}$$
$${ek}=\frac{\mu_4}{\sigma^4}-3$$

$$자크-베라의 검정통계량은 점근적으로\chi^2_2-분포를 따른다.$$

$${LM}=n(\frac{sk^2}{6}+\frac{ek^2}{24})$$

검정통계량 LM > 임계값 : 귀무가설기각(오차항은 정규분포를 따르지 않는다.)

검정통계량 LM < 임계값 : 귀무가설채택(오차항은 정규분포를 따른다.)

*자크-베라 검정을 위한 R 함수 : jarque.bera.test (tseries 패키지)  

**표8-1** jarque.bera.test() 함수

형태|   |jaeque.bera.test(x)
----|---|----------------------------------
인수|x  |수치형 데이터 혹은 시계열 자료형태


*그 밖의 함수들

 +shapiro-wilk 정규성검정, 기본 내장함수, shapiro.test()

 +anderson-darling 정규성검정, nortest패키지 내장, ad.test()


*예제8-2*
*Question. 이번에는 제7장의 예제 7-20에서 소개한 케인즈 소비함소의 회귀분석 결과를 바탕으로 오차항이 정규분포하는지 여부를 자크-베라 통계량을 이용하여 검증해보라.*

```{r}
#자크베라검정
library(tseries)
jarque.bera.test(resid(key.res))
qchisq(0.05,df=2,lower.tail=F)
```

### 2. 오차항이 비정규분포를 갖는 경우의 추정방법

#### 1) 최우추정량



```{r}
```



```{r, echo=FALSE}
plot(cars)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
